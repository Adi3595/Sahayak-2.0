<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sahayak - Materials Dashboard</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Manrope:wght@400;500;600;700;800&display=swap');
        
        :root {
            --primary: #7c3aed;
            --primary-light: #8b5cf6;
            --primary-dark: #6d28d9;
            --secondary: #10b981;
            --accent: #f59e0b;
            --background: #0f0f23;
            --surface: #1a1a2e;
            --text: #f8fafc;
            --text-secondary: #94a3b8;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background);
            color: var(--text);
            overflow-x: hidden;
        }
        
        .font-heading {
            font-family: 'Manrope', sans-serif;
        }
        
        /* Custom animations */
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        @keyframes pulse-glow {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-30px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .animate-float {
            animation: float 6s ease-in-out infinite;
        }
        
        .animate-pulse-glow {
            animation: pulse-glow 3s ease-in-out infinite;
        }
        
        .animate-fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }
        
        .animate-slide-in {
            animation: slideIn 0.8s ease-out forwards;
        }
        
        /* Glass effect */
        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        /* Gradient text */
        .gradient-text {
            background: linear-gradient(135deg, var(--primary), var(--secondary), var(--accent));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            background-size: 200% 200%;
            animation: gradient 8s ease infinite;
        }
        
        /* Grid background pattern */
        .grid-pattern {
            background-image: 
                linear-gradient(rgba(124, 58, 237, 0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(124, 58, 237, 0.1) 1px, transparent 1px);
            background-size: 50px 50px;
        }
        
        /* Card hover effects */
        .feature-card {
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.7s;
        }
        
        .feature-card:hover::before {
            left: 100%;
        }
        
        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            border-color: var(--primary);
        }
        
        /* Button effects */
        .btn-primary {
            position: relative;
            overflow: hidden;
        }
        
        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.7s;
        }
        
        .btn-primary:hover::before {
            left: 100%;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--surface);
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, var(--primary), var(--secondary));
            border-radius: 5px;
        }
        
        /* Sidebar Styles - Enhanced */
        .sidebar {
            width: 280px !important;
            background: var(--surface);
            border-right: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
            position: fixed;
            left: 0;
            top: 0;
            bottom: 0;
            z-index: 1000;
            overflow-y: auto;
            transition: none !important;
        }
        
        .sidebar-header {
            padding: 25px 20px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-icon {
            background: linear-gradient(to right, var(--primary), var(--accent));
            width: 45px;
            height: 45px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            color: white;
            box-shadow: 0 4px 12px rgba(108, 99, 255, 0.3);
            flex-shrink: 0;
        }
        
        .logo-text {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            transition: opacity 0.3s ease;
        }
        
        .sidebar.collapsed .logo-text {
            opacity: 0;
            width: 0;
        }
        
        .logo-text h1 {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary), var(--secondary), var(--accent), var(--primary));
            background-size: 200% 200%;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradient 6s ease infinite;
            line-height: 1.2;
        }
        
        .logo-text span {
            font-size: 0.8rem;
            color: var(--text-secondary);
            letter-spacing: 1px;
        }
        
        .sidebar-toggle {
            position: absolute;
            top: 50%;
            right: -12px;
            transform: translateY(-50%);
            width: 24px;
            height: 24px;
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: 2px solid var(--surface);
            transition: all 0.3s ease;
            z-index: 1001;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }
        
        .sidebar-toggle:hover {
            transform: translateY(-50%) scale(1.1);
            box-shadow: 0 0 15px rgba(124, 58, 237, 0.4);
        }
        
        .sidebar-toggle i {
            color: white;
            font-size: 0.8rem;
            transition: transform 0.3s ease;
        }

        .sidebar-toggle {
            display: none !important;
        }
        
        .sidebar.collapsed .sidebar-toggle i {
            transform: rotate(180deg);
        }
        
        .sidebar-nav {
            flex: 1;
            padding: 25px 15px;
            overflow-y: auto;
        }
        
        .nav-section {
            margin-bottom: 25px;
        }
        
        .nav-title {
            color: var(--text-secondary);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 0 15px 10px;
            margin-bottom: 10px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            transition: opacity 0.3s ease;
        }
        
        .sidebar.collapsed .nav-title {
            opacity: 0;
        }
        
        .nav-list {
            list-style: none;
        }
        
        .nav-item {
            margin-bottom: 5px;
            position: relative;
        }
        
        .nav-link {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 14px 20px;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 12px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .nav-link:hover {
            background: rgba(124, 58, 237, 0.1);
            color: var(--text);
            transform: translateX(5px);
        }
        
        .nav-link.active {
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: 0 4px 15px rgba(124, 58, 237, 0.3);
        }
        
        .nav-icon {
            font-size: 1.25rem;
            min-width: 24px;
            text-align: center;
            transition: transform 0.2s ease;
        }
        
        .nav-link:hover .nav-icon {
            transform: scale(1.1);
        }
        
        .nav-text {
            font-weight: 500;
            white-space: nowrap;
            transition: opacity 0.3s ease;
        }
        
        .sidebar.collapsed .nav-text {
            opacity: 0;
            width: 0;
        }
        
        .nav-badge {
            background: var(--secondary);
            color: white;
            font-size: 0.7rem;
            padding: 2px 8px;
            border-radius: 10px;
            font-weight: 700;
            margin-left: auto;
            transition: opacity 0.3s ease;
        }
        
        .sidebar.collapsed .nav-badge {
            opacity: 0;
        }
        
        /* Tooltips for collapsed sidebar */
        .nav-link::after {
            content: attr(data-tooltip);
            position: absolute;
            left: 100%;
            top: 50%;
            transform: translateY(-50%) translateX(10px);
            background: var(--surface);
            color: var(--text);
            padding: 10px 15px;
            border-radius: 8px;
            font-size: 0.85rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1001;
            border: 1px solid rgba(255, 255, 255, 0.1);
            pointer-events: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .sidebar.collapsed .nav-link:hover::after {
            opacity: 1;
            visibility: visible;
            transform: translateY(-50%) translateX(15px);
        }
        
        /* Mobile Toggle Button */
        .mobile-toggle {
            display: none;
            position: fixed;
            top: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: linear-gradient(to right, var(--primary), var(--accent));
            border-radius: 12px;
            border: none;
            color: white;
            font-size: 1.3rem;
            cursor: pointer;
            align-items: center;
            justify-content: center;
            z-index: 999;
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.3);
            transition: all 0.3s;
        }
        
        .mobile-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(124, 58, 237, 0.4);
        }
        
        /* Main Content Area */
        .main-content {
            flex: 1;
            margin-left: 280px;
            transition: margin-left 0.3s ease;
            min-height: 100vh;
            padding: 30px;
            position: relative;
        }
        
        /* Nav tabs */
        .nav-tabs {
            display: flex;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.03);
            padding: 0.5rem;
            border-radius: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            margin: 2rem 0 3rem;
        }
        
        .nav-tab {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            padding: 1.25rem 1.5rem;
            background: transparent;
            border: none;
            border-radius: 0.75rem;
            color: var(--text-secondary);
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .nav-tab:hover {
            color: var(--text);
            background: rgba(124, 58, 237, 0.1);
        }
        
        .nav-tab.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 10px 30px rgba(124, 58, 237, 0.3);
        }
        
        .tab-badge {
            background: var(--secondary);
            color: var(--background);
            font-size: 0.75rem;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-weight: 700;
        }
        
        /* Glass Cards */
        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 2.5rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .glass-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 60px rgba(124, 58, 237, 0.3);
            border-color: rgba(124, 58, 237, 0.3);
        }
        
        /* Section Header */
        .section-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .section-icon {
            width: 70px;
            height: 70px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.75rem;
            position: relative;
            overflow: hidden;
        }
        
        .section-title {
            font-family: 'Manrope', sans-serif;
            font-weight: 800;
            font-size: 1.75rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .section-description {
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }
        
        /* Upload Area */
        .upload-area {
            border: 2px dashed rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 3rem 2rem;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            background: rgba(255, 255, 255, 0.03);
            position: relative;
            overflow: hidden;
            margin-bottom: 2rem;
        }
        
        .upload-area:hover {
            border-color: var(--primary);
            background: rgba(124, 58, 237, 0.05);
        }
        
        .upload-icon {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        /* Form Elements */
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-primary);
            font-family: 'Manrope', sans-serif;
        }
        
        .form-control {
            width: 100%;
            padding: 1rem 1.25rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0.75rem;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.3);
            background: rgba(124, 58, 237, 0.05);
        }
        
        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 0.75rem;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(124, 58, 237, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 20px 40px rgba(124, 58, 237, 0.4);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .btn-secondary:hover {
            background: rgba(124, 58, 237, 0.1);
            border-color: var(--primary);
        }
        
        .btn-full {
            width: 100%;
        }
        
        /* Grade Selection */
        .grade-selection {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 0.75rem;
            margin: 1.5rem 0;
        }
        
        .grade-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid transparent;
            border-radius: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .grade-option:hover {
            border-color: var(--primary);
            background: rgba(124, 58, 237, 0.1);
            transform: translateY(-5px);
        }
        
        .grade-option.selected {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-color: var(--primary);
            box-shadow: 0 10px 30px rgba(124, 58, 237, 0.3);
        }
        
        /* Question Types */
        .question-types {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }
        
        .question-type {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            padding: 1.5rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid transparent;
            border-radius: 0.75rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .question-type:hover {
            border-color: var(--primary);
            background: rgba(124, 58, 237, 0.1);
            transform: translateY(-5px);
        }
        
        .question-type.selected {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-color: var(--primary);
            box-shadow: 0 10px 30px rgba(124, 58, 237, 0.3);
        }
        
        /* PPT Source Selection */
        .ppt-sources {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }
        
        .ppt-source {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid transparent;
            border-radius: 1rem;
            padding: 2rem 1rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .ppt-source:hover {
            border-color: var(--primary);
            background: rgba(124, 58, 237, 0.1);
            transform: translateY(-5px);
        }
        
        .ppt-source.selected {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-color: var(--primary);
            box-shadow: 0 10px 40px rgba(124, 58, 237, 0.2);
        }
        
        .ppt-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--primary);
        }
        
        .ppt-source.selected .ppt-icon {
            color: white;
        }
        
        /* Random Subtopics */
        .subtopics-generator {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 1.5rem;
            margin: 1rem 0;
        }
        
        .random-subtopics {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-top: 1rem;
        }
        
        .subtopic-tag {
            background: rgba(124, 58, 237, 0.1);
            border: 1px solid rgba(124, 58, 237, 0.3);
            border-radius: 50px;
            padding: 0.75rem 1.25rem;
            font-size: 0.9rem;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .subtopic-tag:hover {
            background: rgba(124, 58, 237, 0.2);
            transform: translateY(-2px);
        }
        
        .subtopic-tag.selected {
            background: var(--primary);
            color: var(--background);
            border-color: var(--primary);
        }
        
        /* PPT Source Content */
        .ppt-source-content {
            display: none;
        }
        
        .ppt-source-content.active {
            display: block;
        }
        
        /* Loading Spinner */
        .loading-spinner {
            display: none;
            text-align: center;
            padding: 3rem;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(124, 58, 237, 0.1);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1.5rem;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Message System */
        .message {
            padding: 1rem 1.5rem;
            border-radius: 0.75rem;
            margin: 1rem 0;
            display: none;
            animation: slideUp 0.3s ease;
            border-left: 4px solid;
            backdrop-filter: blur(10px);
        }
        
        .message-success {
            background: rgba(16, 185, 129, 0.1);
            border-left-color: #10b981;
            color: #10b981;
        }
        
        .message-error {
            background: rgba(239, 68, 68, 0.1);
            border-left-color: #ef4444;
            color: #ef4444;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Preview Area */
        .preview-area {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 2rem;
            margin-top: 2rem;
            backdrop-filter: blur(10px);
            display: none;
        }
        
        /* Worksheets Grid */
        .worksheets-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }
        
        .worksheet-card {
            background: var(--card-bg);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
            padding: 1.5rem;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .worksheet-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 40px rgba(124, 58, 237, 0.2);
        }
        
        .worksheet-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .worksheet-grade {
            background: var(--primary);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: 600;
        }
        
        .download-options {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .download-options .btn {
            flex: 1;
            padding: 0.75rem;
            font-size: 0.875rem;
        }
        
        /* Footer */
        footer {
            text-align: center;
            padding: 3rem 0;
            margin-top: 4rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text-secondary);
        }
        
        /* Tooltip for collapsed sidebar */
        .nav-link::after {
            content: attr(data-tooltip);
            position: absolute;
            left: 100%;
            top: 50%;
            transform: translateY(-50%) translateX(10px);
            background: rgba(26, 26, 46, 0.95);
            color: var(--text-primary);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1000;
            border: 1px solid rgba(255, 255, 255, 0.1);
            pointer-events: none;
        }
        
        .sidebar:not(.expanded) .nav-link:hover::after {
            opacity: 1;
            visibility: visible;
            transform: translateY(-50%) translateX(20px);
        }
        
        /* Submenu Styles */
        .has-submenu {
            position: relative;
        }
        
        .nav-arrow {
            transition: transform 0.3s ease;
            margin-left: auto;
            font-size: 0.8rem;
        }
        
        .has-submenu.active .nav-arrow {
            transform: rotate(180deg);
        }
        
        .submenu {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background: rgba(15, 15, 35, 0.8);
            border-radius: 0 0 12px 12px;
            margin: 0 10px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-top: none;
        }
        
        .has-submenu.active .submenu {
            max-height: 400px;
            margin-bottom: 10px;
        }
        
        .submenu .nav-link {
            padding: 10px 16px 10px 34px;
            border-radius: 8px;
            margin: 5px;
            font-size: 0.9rem;
            position: relative;
            background: transparent;
        }
        
        .submenu .nav-link::before {
            content: '';
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 4px;
            background: var(--text-secondary);
            border-radius: 50%;
            opacity: 0.5;
        }
        
        .submenu .nav-link:hover::before,
        .submenu .nav-link.active::before {
            background: var(--accent);
            opacity: 1;
        }
        
        .submenu .nav-link:hover {
            background: rgba(124, 58, 237, 0.1);
            transform: translateX(0);
        }
        
        .submenu .nav-link.active {
            background: rgba(124, 58, 237, 0.15);
            color: var(--text);
            box-shadow: none;
        }
        
        .submenu .nav-link.active::before {
            width: 6px;
            height: 6px;
            background: var(--accent);
        }
        
        .submenu-icon {
            font-size: 1rem;
            width: 20px;
            text-align: center;
            margin-right: 10px;
        }
        
        /* Content Sections */
        .content-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }
        
        .content-section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Responsive Design */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .sidebar-toggle {
                display: none;
            }
            
            .main-content {
                margin-left: 0 !important;
                padding: 20px;
            }
            
            .mobile-toggle {
                display: flex;
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 0 1rem;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .grade-selection {
                grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            }
            
            .question-types {
                grid-template-columns: 1fr;
            }
            
            .ppt-sources {
                grid-template-columns: 1fr;
            }
            
            .worksheets-grid {
                grid-template-columns: 1fr;
            }
            
            .glass-card {
                padding: 1.5rem;
            }
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #10b981;
        }
        
        /* Progress bar for PPT */
        .progress-container {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            height: 20px;
            margin: 1rem 0;
            overflow: hidden;
        }
        
        .progress-bar {
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.8rem;
            font-weight: 600;
        }
    </style>
</head>
<body class="bg-[#0f0f23] text-gray-100">
    <!-- Mobile Toggle Button -->
    <button class="mobile-toggle" id="mobileToggle">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- SIDEBAR NAVIGATION -->
    <aside class="sidebar" id="sidebar">
        
        <!-- Sidebar Header -->
        <div class="sidebar-header">
            <div class="logo-container">
                <div class="logo-icon">
                    <i class="fas fa-brain"></i>
                </div>
                <div class="logo-text">
                    <h1 class="gradient-text">Sahayak</h1>
                    <span>AI Teaching Assistant</span>
                </div>
            </div>
        </div>
        
        <!-- Sidebar Navigation -->
        <nav class="sidebar-nav">
            <!-- Main Navigation -->
            <div class="nav-section">
                <div class="nav-title">Main Navigation</div>
                <ul class="nav-list">
                    <li class="nav-item"></li>
                        <a href="index.html" class="flex items-center gap-3 px-4 py-3 rounded-xl hover:bg-white/10">
                            <i class="fas fa-home"></i>
                            <span class="nav-text">Dashboard</span>
                        </a>
                    </li>
                    <li class="nav-item active">
                        <a href="/Differentiated_materials.html" class="nav-link active" data-tooltip="Materials">
                            <i class="fas fa-layer-group nav-icon"></i>
                            <span class="nav-text">Materials</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/fun_activities.html" class="nav-link" data-tooltip="Fun Activities">
                            <i class="fas fa-gamepad nav-icon"></i>
                            <span class="nav-text">Fun Activities</span>
                            <span class="nav-badge">NEW</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/knowledge_base.html" class="nav-link" data-tooltip="Knowledge Base">
                            <i class="fas fa-lightbulb nav-icon"></i>
                            <span class="nav-text">Knowledge Base</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/lesson_planning.html" class="nav-link" data-tooltip="Lesson Planning">
                            <i class="fas fa-book nav-icon"></i>
                            <span class="nav-text">Lesson Planning</span>
                            <span class="nav-badge">AI</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/blackboard_diagrams.html" class="nav-link" data-tooltip="Dashboard">
                            <i class="fas fa-chalkboard nav-icon"></i>
                            <span class="nav-text">Visual Aids Creator</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/Student_tracking.html" class="nav-link" data-tooltip="Analytics">
                            <i class="fas fa-chart-line nav-icon"></i>
                            <span class="nav-text">Progress Tracking</span>
                        </a>
                    </li>
                </ul>
            </div>
            
            <!-- Account Section -->
            <div class="nav-section">
                <div class="nav-title">Account</div>
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="/profile.html" class="nav-link" data-tooltip="Profile">
                            <i class="fas fa-user nav-icon"></i>
                            <span class="nav-text">Profile</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/settings.html" class="nav-link" data-tooltip="Settings">
                            <i class="fas fa-cog nav-icon"></i>
                            <span class="nav-text">Settings</span>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/help.html" class="nav-link" data-tooltip="Help & Support">
                            <i class="fas fa-question-circle nav-icon"></i>
                            <span class="nav-text">Help & Support</span>
                        </a>
                    </li>
                </ul>
            </div>
        </nav>
        
        <!-- Sidebar Footer -->
        <div class="sidebar-footer p-4">
            <div class="glass rounded-xl p-4">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-gradient-to-br from-purple-600 to-emerald-500 flex items-center justify-center">
                        <i class="fas fa-user text-white"></i>
                    </div>
                    <div class="flex-1">
                        <div class="font-semibold">Teacher Dashboard</div>
                        <div class="text-xs text-gray-400">Premium Access</div>
                    </div>
                </div>
            </div>
        </div>
    </aside>
    
    <!-- MAIN CONTENT AREA -->
    <main class="main-content">
        <!-- Hero Section - Matching Fun Activities Style -->
        <section class="mb-12">
            <div class="relative">
                <div class="absolute top-1/4 left-1/4 w-96 h-96 bg-purple-600/20 rounded-full blur-3xl animate-pulse-glow"></div>
                <div class="absolute bottom-1/4 right-1/4 w-96 h-96 bg-emerald-500/20 rounded-full blur-3xl animate-pulse-glow" style="animation-delay: 1s;"></div>
                
                <div class="relative z-10 text-center mb-8">
                    <div class="flex items-center justify-center gap-4 mb-6">
                        <div class="w-16 h-16 rounded-xl bg-gradient-to-br from-purple-600 to-emerald-500 flex items-center justify-center">
                            <i class="fas fa-layer-group text-white text-2xl"></i>
                        </div>
                        <h1 class="text-5xl md:text-6xl font-bold font-heading">
                            <span class="gradient-text">Teaching Materials</span><br>
                            <span>Powered by AI</span>
                        </h1>
                    </div>
                    <p class="text-xl text-gray-400 max-w-3xl mx-auto">
                        Create summaries, worksheets, learning content, and presentations tailored to your curriculum. 
                        Powered by AI to save you hours of preparation time.
                    </p>
                    <div class="flex flex-wrap gap-3 justify-center mt-6">
                        <span class="px-4 py-2 bg-purple-500/20 border border-purple-500/30 rounded-full">PDF Summarizer</span>
                        <span class="px-4 py-2 bg-emerald-500/20 border border-emerald-500/30 rounded-full">Worksheet Generator</span>
                        <span class="px-4 py-2 bg-amber-500/20 border border-amber-500/30 rounded-full">Content Creator</span>
                        <span class="px-4 py-2 bg-blue-500/20 border border-blue-500/30 rounded-full">PPT Maker</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Navigation Tabs -->
        <div class="nav-tabs">
            <button class="nav-tab active" data-section="pdf-summarizer">
                <i class="fas fa-file-contract"></i>
                <span>PDF Summarizer</span>
            </button>
            <button class="nav-tab" data-section="worksheet-pdf">
                <i class="fas fa-file-alt"></i>
                <span>Worksheet from PDF</span>
                <span class="tab-badge">AI</span>
            </button>
            <button class="nav-tab" data-section="content-generator">
                <i class="fas fa-lightbulb"></i>
                <span>Content Generator</span>
                <span class="tab-badge">NEW</span>
            </button>
            <button class="nav-tab" data-section="ppt-creator">
                <i class="fas fa-presentation-screen"></i>
                <span>PPT Creator</span>
            </button>
        </div>
        
        <!-- PDF Summarizer Section -->
        <section class="content-section active" id="pdf-summarizer-section">
            <div class="glass-card">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-file-contract"></i>
                    </div>
                    <div>
                        <h2 class="section-title">PDF Summarizer</h2>
                        <p class="section-description">Upload any document and get AI-powered summaries instantly</p>
                    </div>
                </div>
                
                <div class="upload-area" id="pdfUploadArea">
                    <div class="upload-icon">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <h3 style="margin-bottom: 0.5rem;">Drop your PDF here</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">Supports PDF, DOC, DOCX, TXT formats</p>
                    <input type="file" id="pdfFileInput" accept=".pdf,.doc,.docx,.txt" style="display: none;">
                    <button class="btn" onclick="document.getElementById('pdfFileInput').click()">
                        <i class="fas fa-folder-open"></i> Browse Files
                    </button>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Summary Options</label>
                    <div style="display: flex; gap: 1rem; align-items: center;">
                        <input type="number" class="form-control" placeholder="Start page" id="pageStart" min="1" value="1">
                        <span style="color: var(--text-secondary);">to</span>
                        <input type="number" class="form-control" placeholder="End page" id="pageEnd" min="1">
                    </div>
                    <small style="color: var(--text-secondary); display: block; margin-top: 0.5rem;">Leave empty for entire document</small>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Summary Length</label>
                    <select class="form-control" id="summaryLength">
                        <option value="short">Short (1-2 paragraphs)</option>
                        <option value="medium" selected>Medium (3-4 paragraphs)</option>
                        <option value="detailed">Detailed (5+ paragraphs)</option>
                    </select>
                </div>
                
                <button class="btn btn-full" onclick="generateSummary()">
                    <i class="fas fa-file-contract"></i> Generate AI Summary
                </button>
                
                <div class="loading-spinner" id="summaryLoading">
                    <div class="spinner"></div>
                    <p style="color: var(--text-secondary);">Analyzing and summarizing your document...</p>
                </div>
                
                <div class="preview-area" id="summaryPreview">
                    <h3 style="font-family: 'Manrope', sans-serif; font-weight: 700; margin-bottom: 1rem;">Summary Preview</h3>
                    <div id="summaryContent"></div>
                    <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
                        <button class="btn" id="downloadSummaryPdf">
                            <i class="fas fa-download"></i> Download PDF
                        </button>
                        <button class="btn-secondary" id="copySummaryText">
                            <i class="fas fa-copy"></i> Copy Text
                        </button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Worksheet from PDF Section -->
        <section class="content-section" id="worksheet-pdf-section">
            <div class="glass-card">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <div>
                        <h2 class="section-title">Worksheet Generator (PDF)</h2>
                        <p class="section-description">Create differentiated worksheets from any document</p>
                    </div>
                </div>
                
                <div class="upload-area" id="worksheetUploadArea">
                    <div class="upload-icon">
                        <i class="fas fa-file-upload"></i>
                    </div>
                    <h3 style="margin-bottom: 0.5rem;">Upload PDF to Create Worksheet</h3>
                    <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">AI will analyze and create questions automatically</p>
                    <input type="file" id="worksheetFileInput" accept=".pdf,.doc,.docx,.txt" style="display: none;">
                    <button class="btn" onclick="document.getElementById('worksheetFileInput').click()">
                        <i class="fas fa-folder-open"></i> Select Document
                    </button>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Target Grade Levels</label>
                    <div class="grade-selection">
                        <div class="grade-option" data-grade="k">
                            <i class="fas fa-child"></i>
                            <span>Kindergarten</span>
                        </div>
                        <div class="grade-option" data-grade="1-3">
                            <i class="fas fa-graduation-cap"></i>
                            <span>Grades 1-3</span>
                        </div>
                        <div class="grade-option selected" data-grade="4-6">
                            <i class="fas fa-book"></i>
                            <span>Grades 4-6</span>
                        </div>
                        <div class="grade-option" data-grade="7-9">
                            <i class="fas fa-user-graduate"></i>
                            <span>Grades 7-9</span>
                        </div>
                        <div class="grade-option" data-grade="10-12">
                            <i class="fas fa-university"></i>
                            <span>Grades 10-12</span>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Question Types</label>
                    <div class="question-types">
                        <div class="question-type selected" data-type="mcq">
                            <i class="fas fa-check-circle"></i>
                            <span>Multiple Choice</span>
                        </div>
                        <div class="question-type selected" data-type="theory">
                            <i class="fas fa-edit"></i>
                            <span>Theory/Short Answer</span>
                        </div>
                        <div class="question-type" data-type="essay">
                            <i class="fas fa-file-alt"></i>
                            <span>Essay</span>
                        </div>
                        <div class="question-type" data-type="truefalse">
                            <i class="fas fa-balance-scale"></i>
                            <span>True/False</span>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Number of Questions</label>
                    <input type="range" class="form-control" id="questionCount" min="5" max="30" value="15" style="padding: 0;">
                    <div style="text-align: center; margin-top: 0.5rem;">
                        <span style="font-weight: 600; color: var(--primary);" id="questionCountValue">15</span> questions
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Difficulty Level</label>
                    <select class="form-control" id="difficulty">
                        <option value="easy">Easy</option>
                        <option value="medium" selected>Medium</option>
                        <option value="hard">Hard</option>
                    </select>
                </div>
                
                <button class="btn btn-full" onclick="generateWorksheet()">
                    <i class="fas fa-magic"></i> Generate Differentiated Worksheets
                </button>
                
                <div class="loading-spinner" id="worksheetLoading">
                    <div class="spinner"></div>
                    <p style="color: var(--text-secondary);">Creating worksheets for different grade levels...</p>
                </div>
                
                <div class="worksheets-grid" id="worksheetsGrid" style="display: none;"></div>
            </div>
        </section>
        
        <!-- Content Generator Section -->
        <section class="content-section" id="content-generator-section">
            <div class="glass-card">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-lightbulb"></i>
                    </div>
                    <div>
                        <h2 class="section-title">Content Generator</h2>
                        <p class="section-description">Generate learning content from topics and concepts</p>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Main Topic</label>
                    <input type="text" class="form-control" id="mainTopic" placeholder="e.g., Machine Learning, World War II, Photosynthesis" oninput="generateRandomSubtopics()">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Subject Area</label>
                    <div class="grade-selection">
                        <div class="grade-option" data-subject="Science">
                            <i class="fas fa-flask"></i>
                            <span>Science</span>
                        </div>
                        <div class="grade-option" data-subject="Mathematics">
                            <i class="fas fa-calculator"></i>
                            <span>Mathematics</span>
                        </div>
                        <div class="grade-option" data-subject="History">
                            <i class="fas fa-landmark"></i>
                            <span>History</span>
                        </div>
                        <div class="grade-option selected" data-subject="Computer Science">
                            <i class="fas fa-laptop-code"></i>
                            <span>Computer Science</span>
                        </div>
                        <div class="grade-option" data-subject="Language Arts">
                            <i class="fas fa-language"></i>
                            <span>Language Arts</span>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Grade Levels</label>
                    <select class="form-control" id="contentGrades">
                        <option value="k">Kindergarten</option>
                        <option value="1-3">Grades 1-3</option>
                        <option value="4-6" selected>Grades 4-6</option>
                        <option value="7-9">Grades 7-9</option>
                        <option value="10-12">Grades 10-12</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Learning Objectives (Optional)</label>
                    <textarea class="form-control" id="learningObjectives" rows="3" placeholder="What should students learn from this content?"></textarea>
                </div>
                
                <div class="subtopics-generator">
                    <label class="form-label">Subtopics</label>
                    <p style="color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 1rem;">Add or select subtopics to include:</p>
                    <div class="random-subtopics" id="randomSubtopics">
                        <!-- Subtopics will be generated here -->
                    </div>
                    <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                        <input type="text" class="form-control" id="customSubtopic" placeholder="Add custom subtopic...">
                        <button class="btn-secondary" onclick="addCustomSubtopic()">
                            <i class="fas fa-plus"></i> Add
                        </button>
                        <button class="btn-secondary" onclick="generateSubtopicsFromAI()">
                            <i class="fas fa-robot"></i> AI Suggest
                        </button>
                    </div>
                </div>
                
                <button class="btn btn-full" onclick="generateContent()">
                    <i class="fas fa-play-circle"></i> Generate Learning Content
                </button>
                
                <div class="loading-spinner" id="contentLoading">
                    <div class="spinner"></div>
                    <p style="color: var(--text-secondary);">Creating comprehensive learning content...</p>
                </div>
                
                <div class="worksheets-grid" id="contentWorksheets" style="display: none; margin-top: 2rem;"></div>
            </div>
        </section>
        
        <!-- PPT Creator Section -->
        <section class="content-section" id="ppt-creator-section">
            <div class="glass-card">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-presentation-screen"></i>
                    </div>
                    <div>
                        <h2 class="section-title">PPT Creator</h2>
                        <p class="section-description">Create stunning presentations from various sources</p>
                    </div>
                </div>
                
                <div class="ppt-sources">
                    <div class="ppt-source selected" data-source="topic">
                        <div class="ppt-icon">
                            <i class="fas fa-lightbulb"></i>
                        </div>
                        <h3>From Topic</h3>
                        <p style="color: var(--text-secondary); font-size: 0.9rem;">Create PPT from topic</p>
                    </div>
                    <div class="ppt-source" data-source="document">
                        <div class="ppt-icon">
                            <i class="fas fa-file-pdf"></i>
                        </div>
                        <h3>From Document</h3>
                        <p style="color: var(--text-secondary); font-size: 0.9rem;">Convert PDF/DOC to PPT</p>
                    </div>
                </div>
                
                <!-- From Topic Form -->
                <div class="ppt-source-content active" id="topicForm">
                    <div class="form-group">
                        <label class="form-label">Presentation Topic</label>
                        <input type="text" class="form-control" id="pptTopic" placeholder="Enter your presentation topic" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Subject Area</label>
                        <select class="form-control" id="pptSubject">
                            <option value="General">General</option>
                            <option value="Science">Science</option>
                            <option value="Mathematics">Mathematics</option>
                            <option value="History">History</option>
                            <option value="Computer Science">Computer Science</option>
                            <option value="Language Arts">Language Arts</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Number of Slides</label>
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <button type="button" class="btn-secondary" onclick="adjustSlides(-5)">-5</button>
                            <input type="range" class="form-control" id="slideCount" min="5" max="50" value="15" style="flex: 1; padding: 0;">
                            <button type="button" class="btn-secondary" onclick="adjustSlides(5)">+5</button>
                        </div>
                        <div style="text-align: center; margin-top: 0.5rem;">
                            <span style="font-weight: 600; color: var(--primary);" id="slideCountValue">15</span> slides
                        </div>
                    </div>
                </div>
                
                <!-- From Document Form -->
                <div class="ppt-source-content" id="documentForm">
                    <div class="upload-area" id="pptUploadArea">
                        <div class="upload-icon">
                            <i class="fas fa-file-upload"></i>
                        </div>
                        <h3 style="margin-bottom: 0.5rem;">Upload Document for PPT</h3>
                        <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">Supports PDF, DOC, DOCX formats</p>
                        <input type="file" id="pptFileInput" accept=".pdf,.doc,.docx" style="display: none;">
                        <button class="btn" onclick="document.getElementById('pptFileInput').click()">
                            <i class="fas fa-folder-open"></i> Select Document
                        </button>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Presentation Style</label>
                        <select class="form-control" id="pptStyle">
                            <option value="professional">Professional</option>
                            <option value="academic" selected>Academic</option>
                            <option value="creative">Creative</option>
                            <option value="minimal">Minimal</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Presentation Style (From Topic)</label>
                    <select class="form-control" id="pptStyleTopic">
                        <option value="professional">Professional</option>
                        <option value="academic" selected>Academic</option>
                        <option value="creative">Creative</option>
                        <option value="minimal">Minimal</option>
                    </select>
                </div>
                
                <button class="btn btn-full" onclick="createPresentation()">
                    <i class="fas fa-magic"></i> Generate PowerPoint
                </button>
                
                <div class="loading-spinner" id="pptLoading">
                    <div class="spinner"></div>
                    <p style="color: var(--text-secondary);">Creating your presentation...</p>
                </div>
                
                <!-- PPT Progress Tracking -->
                <div id="pptProgressContainer" style="display: none; margin-top: 2rem;">
                    <h4 style="margin-bottom: 1rem;">PPT Generation Progress</h4>
                    <div class="progress-container">
                        <div class="progress-bar" id="pptProgressBar" style="width: 0%">0%</div>
                    </div>
                    <div style="text-align: center; margin-top: 1rem;">
                        <button class="btn-secondary" id="checkPptStatus" onclick="checkPptStatus()" style="display: none;">
                            <i class="fas fa-sync-alt"></i> Check Status
                        </button>
                        <a id="pptDownloadLink" class="btn" style="display: none;" target="_blank">
                            <i class="fas fa-download"></i> Download PPT
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="mt-12 pt-8 border-t border-white/10 text-center text-gray-500">
            <p>Sahayak AI &copy; 2023</p>
        </footer>
    </main>

    <script>
        // Configuration
        const API_BASE_URL = window.location.origin;
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Sidebar functionality
            const sidebar = document.getElementById('sidebar');
            const mobileToggle = document.getElementById('mobileToggle');
            
            // Mobile menu toggle
            mobileToggle.addEventListener('click', function() {
                sidebar.classList.toggle('active');
                this.querySelector('i').classList.toggle('fa-bars');
                this.querySelector('i').classList.toggle('fa-times');
            });
            
            // Close mobile sidebar when clicking outside
            document.addEventListener('click', function(e) {
                if (window.innerWidth <= 1024) {
                    if (!sidebar.contains(e.target) && !mobileToggle.contains(e.target)) {
                        sidebar.classList.remove('active');
                        mobileToggle.querySelector('i').classList.remove('fa-times');
                        mobileToggle.querySelector('i').classList.add('fa-bars');
                    }
                }
            });
            
            // Initialize sidebar as expanded
            sidebar.classList.remove('collapsed');
            
            // Handle window resize
            window.addEventListener('resize', function() {
                if (window.innerWidth > 1024) {
                    sidebar.classList.remove('active');
                    mobileToggle.querySelector('i').classList.remove('fa-times');
                    mobileToggle.querySelector('i').classList.add('fa-bars');
                }
            });

            // Navigation
            setupNavigation();
            
            // Grade selection
            setupSelection('.grade-option[data-grade]');
            
            // Question type selection
            setupSelection('.question-type');
            
            // PPT source selection
            setupPPTSourceSelection();
            
            // Subject selection
            setupRadioSelection('.grade-option[data-subject]');
            
            // File upload handlers
            setupFileUploads();
            
            // Range input handlers
            setupRangeInputs();
            
            // Generate initial random subtopics
            generateRandomSubtopics();
            
            // Test backend connection
            testBackendConnection();
        });
        
        // Test backend connection
        async function testBackendConnection() {
            try {
                const response = await fetch(`${API_BASE_URL}/health`);
                if (!response.ok) {
                    console.warn('Backend connection test failed');
                }
            } catch (error) {
                console.error('Cannot connect to backend:', error);
            }
        }
        
        function setupNavigation() {
            const navTabs = document.querySelectorAll('.nav-tab');
            const sections = document.querySelectorAll('.content-section');
            
            navTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const targetSection = this.getAttribute('data-section');
                    
                    // Update active tab
                    navTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Show target section
                    sections.forEach(section => {
                        section.classList.remove('active');
                        if (section.id === `${targetSection}-section`) {
                            section.classList.add('active');
                        }
                    });
                    
                    // Hide all preview areas
                    document.querySelectorAll('.preview-area').forEach(preview => {
                        preview.style.display = 'none';
                    });
                    
                    // Hide all loading spinners
                    document.querySelectorAll('.loading-spinner').forEach(loading => {
                        loading.style.display = 'none';
                    });
                });
            });
        }
        
        function setupSelection(selector) {
            document.querySelectorAll(selector).forEach(element => {
                element.addEventListener('click', function() {
                    this.classList.toggle('selected');
                });
            });
        }
        
        function setupRadioSelection(selector) {
            document.querySelectorAll(selector).forEach(element => {
                element.addEventListener('click', function() {
                    document.querySelectorAll(selector).forEach(el => el.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });
        }
        
        function setupPPTSourceSelection() {
            const pptSources = document.querySelectorAll('.ppt-source');
            const pptForms = document.querySelectorAll('.ppt-source-content');
            
            pptSources.forEach(source => {
                source.addEventListener('click', function() {
                    const sourceType = this.getAttribute('data-source');
                    
                    // Update active source
                    pptSources.forEach(s => s.classList.remove('selected'));
                    this.classList.add('selected');
                    
                    // Show corresponding form
                    pptForms.forEach(form => form.classList.remove('active'));
                    document.getElementById(`${sourceType}Form`).classList.add('active');
                });
            });
        }
        
        function setupFileUploads() {
            // PDF Summarizer file upload
            const pdfUploadArea = document.getElementById('pdfUploadArea');
            const pdfFileInput = document.getElementById('pdfFileInput');
            
            if (pdfUploadArea) {
                pdfUploadArea.addEventListener('click', () => pdfFileInput.click());
                setupFilePreview(pdfFileInput, pdfUploadArea);
            }
            
            // Worksheet file upload
            const worksheetUploadArea = document.getElementById('worksheetUploadArea');
            const worksheetFileInput = document.getElementById('worksheetFileInput');
            
            if (worksheetUploadArea) {
                worksheetUploadArea.addEventListener('click', () => worksheetFileInput.click());
                setupFilePreview(worksheetFileInput, worksheetUploadArea);
            }
            
            // PPT file upload
            const pptUploadArea = document.getElementById('pptUploadArea');
            const pptFileInput = document.getElementById('pptFileInput');
            
            if (pptUploadArea) {
                pptUploadArea.addEventListener('click', () => pptFileInput.click());
                setupFilePreview(pptFileInput, pptUploadArea);
            }
            
            // Add drag and drop functionality
            [pdfUploadArea, worksheetUploadArea, pptUploadArea].forEach(area => {
                if (area) {
                    setupDragAndDrop(area);
                }
            });
        }
        
        function setupFilePreview(fileInput, uploadArea) {
            fileInput.addEventListener('change', function() {
                if (this.files.length) {
                    const file = this.files[0];
                    const fileName = file.name;
                    const fileSize = (file.size / 1024 / 1024).toFixed(2);
                    
                    uploadArea.innerHTML = `
                        <div style="text-align: center;">
                            <div style="font-size: 2.5rem; color: var(--primary); margin-bottom: 1rem;">
                                <i class="fas fa-file-check"></i>
                            </div>
                            <h3 style="margin-bottom: 0.5rem;">${fileName}</h3>
                            <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                                ${fileSize} MB  Ready to process
                            </p>
                            <button class="btn-secondary" onclick="resetFileInput('${fileInput.id}', '${uploadArea.id}')">
                                <i class="fas fa-redo"></i> Change File
                            </button>
                        </div>
                    `;
                    
                    showMessage(`File "${fileName}" uploaded successfully!`, 'success');
                }
            });
        }
        
        function resetFileInput(inputId, areaId) {
            const fileInput = document.getElementById(inputId);
            const uploadArea = document.getElementById(areaId);
            
            fileInput.value = '';
            uploadArea.innerHTML = `
                <div class="upload-icon">
                    <i class="fas fa-cloud-upload-alt"></i>
                </div>
                <h3 style="margin-bottom: 0.5rem;">Drop your file here</h3>
                <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">Click to browse or drag and drop</p>
                <button class="btn" onclick="document.getElementById('${inputId}').click()">
                    <i class="fas fa-folder-open"></i> Browse Files
                </button>
            `;
        }
        
        function setupDragAndDrop(area) {
            area.addEventListener('dragover', (e) => {
                e.preventDefault();
                area.style.borderColor = 'var(--primary)';
                area.style.background = 'rgba(124, 58, 237, 0.05)';
            });
            
            area.addEventListener('dragleave', () => {
                area.style.borderColor = '';
                area.style.background = '';
            });
            
            area.addEventListener('drop', (e) => {
                e.preventDefault();
                area.style.borderColor = '';
                area.style.background = '';
                
                if (e.dataTransfer.files.length) {
                    let fileInput;
                    if (area.id === 'pdfUploadArea') fileInput = document.getElementById('pdfFileInput');
                    else if (area.id === 'worksheetUploadArea') fileInput = document.getElementById('worksheetFileInput');
                    else if (area.id === 'pptUploadArea') fileInput = document.getElementById('pptFileInput');
                    
                    if (fileInput) {
                        fileInput.files = e.dataTransfer.files;
                        fileInput.dispatchEvent(new Event('change'));
                    }
                }
            });
        }
        
        function setupRangeInputs() {
            // Question count range
            const questionCount = document.getElementById('questionCount');
            if (questionCount) {
                questionCount.addEventListener('input', function() {
                    document.getElementById('questionCountValue').textContent = this.value;
                });
            }
            
            // Slide count range
            const slideCount = document.getElementById('slideCount');
            if (slideCount) {
                slideCount.addEventListener('input', function() {
                    document.getElementById('slideCountValue').textContent = this.value;
                });
            }
        }
        
        function adjustSlides(amount) {
            const slideCount = document.getElementById('slideCount');
            let newValue = parseInt(slideCount.value) + amount;
            newValue = Math.max(5, Math.min(50, newValue));
            slideCount.value = newValue;
            document.getElementById('slideCountValue').textContent = newValue;
        }
        
        // Random subtopics database
        const subtopicDatabase = {
            "Science": ["Cell Structure", "Photosynthesis", "Chemical Reactions", "Forces and Motion", "Electricity"],
            "Mathematics": ["Algebra", "Geometry", "Calculus", "Statistics", "Probability"],
            "History": ["Ancient Civilizations", "World Wars", "Industrial Revolution", "Renaissance", "Cold War"],
            "Computer Science": ["Programming Basics", "Data Structures", "Algorithms", "Networking", "Database"],
            "Language Arts": ["Grammar Rules", "Vocabulary Building", "Reading Comprehension", "Writing Skills", "Phonetics"]
        };
        
        function generateRandomSubtopics() {
            const mainTopic = document.getElementById('mainTopic').value;
            const subjectElement = document.querySelector('.grade-option[data-subject].selected');
            const subject = subjectElement ? subjectElement.getAttribute('data-subject') : 'Computer Science';
            
            const container = document.getElementById('randomSubtopics');
            container.innerHTML = '';
            
            // Get subtopics for selected subject
            const subtopics = subtopicDatabase[subject] || subtopicDatabase["Computer Science"];
            
            // Shuffle array and take 5 random subtopics
            const shuffled = [...subtopics].sort(() => 0.5 - Math.random());
            const selectedSubtopics = shuffled.slice(0, 5);
            
            // Add main topic as first subtopic if exists
            if (mainTopic.trim()) {
                addSubtopicTag(mainTopic, container);
            }
            
            // Add random subtopics
            selectedSubtopics.forEach(subtopic => {
                addSubtopicTag(subtopic, container);
            });
        }
        
        function addSubtopicTag(subtopic, container) {
            const tag = document.createElement('div');
            tag.className = 'subtopic-tag selected';
            tag.innerHTML = `
                <span>${subtopic}</span>
                <i class="fas fa-times" onclick="this.parentElement.remove()" style="cursor: pointer; font-size: 0.8rem;"></i>
            `;
            container.appendChild(tag);
        }
        
        function addCustomSubtopic() {
            const input = document.getElementById('customSubtopic');
            const subtopic = input.value.trim();
            
            if (subtopic) {
                const container = document.getElementById('randomSubtopics');
                addSubtopicTag(subtopic, container);
                input.value = '';
                showMessage(`Added subtopic: ${subtopic}`, 'success');
            }
        }
        
        async function generateSubtopicsFromAI() {
            const mainTopic = document.getElementById('mainTopic').value.trim();
            
            if (!mainTopic) {
                showMessage('Please enter a main topic first', 'error');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/generate-subtopics`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        main_topic: mainTopic
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                
                const result = await response.json();
                
                // Update subtopics container
                const container = document.getElementById('randomSubtopics');
                container.innerHTML = '';
                
                // Add main topic
                if (mainTopic) {
                    addSubtopicTag(mainTopic, container);
                }
                
                // Add AI-generated subtopics
                result.subtopics.forEach(subtopic => {
                    addSubtopicTag(subtopic, container);
                });
                
                showMessage('AI-generated subtopics loaded!', 'success');
            } catch (error) {
                console.error('Subtopic generation error:', error);
                showMessage('Could not generate subtopics. Using default ones.', 'error');
                generateRandomSubtopics();
            }
        }
        
        function showMessage(text, type) {
            // Remove existing messages
            document.querySelectorAll('.message').forEach(msg => msg.remove());
            
            // Create new message
            const message = document.createElement('div');
            message.className = `message message-${type}`;
            message.innerHTML = `<i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-circle'}"></i> ${text}`;
            message.style.display = 'block';
            
            // Add message to active section
            const activeSection = document.querySelector('.content-section.active');
            if (activeSection) {
                const glassCard = activeSection.querySelector('.glass-card');
                if (glassCard) {
                    glassCard.prepend(message);
                }
            }
            
            // Auto-remove after 5 seconds
            setTimeout(() => {
                if (message.parentNode) {
                    message.remove();
                }
            }, 5000);
        }
        
        // Helper function for API calls
        async function makeApiCall(endpoint, formData) {
            try {
                const response = await fetch(`${API_BASE_URL}${endpoint}`, {
                    method: 'POST',
                    body: formData
                });
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.detail || `HTTP ${response.status}: ${response.statusText}`);
                }
                
                return await response.json();
            } catch (error) {
                console.error('API Error:', error);
                throw error;
            }
        }
        
        // Real PDF Summarizer Function
        async function generateSummary() {
            const fileInput = document.getElementById('pdfFileInput');
            const pageStart = document.getElementById('pageStart').value;
            const pageEnd = document.getElementById('pageEnd').value || null;
            const summaryLength = document.getElementById('summaryLength').value;
            
            if (!fileInput.files.length) {
                showMessage('Please select a file first', 'error');
                return;
            }
            
            const loading = document.getElementById('summaryLoading');
            const preview = document.getElementById('summaryPreview');
            
            loading.style.display = 'block';
            preview.style.display = 'none';
            
            try {
                const formData = new FormData();
                formData.append('file', fileInput.files[0]);
                formData.append('summary_length', summaryLength);
                formData.append('page_start', pageStart);
                if (pageEnd) formData.append('page_end', pageEnd);
                
                const result = await makeApiCall('/summarize-pdf/', formData);
                
                loading.style.display = 'none';
                preview.style.display = 'block';
                
                // Display summary
                document.getElementById('summaryContent').innerHTML = `
                    <div style="background: rgba(255, 255, 255, 0.03); padding: 1.5rem; border-radius: 0.75rem;">
                        <h4 style="color: var(--primary); margin-bottom: 1rem;">
                            AI-Generated Summary (${summaryLength})
                        </h4>
                        <p style="white-space: pre-wrap; line-height: 1.6;">${result.summary}</p>
                        <div style="margin-top: 1.5rem; padding-top: 1rem; border-top: 1px solid rgba(255, 255, 255, 0.1);">
                            <small style="color: var(--text-secondary);">
                                Pages: ${result.page_range}<br>
                                File: ${fileInput.files[0].name}
                            </small>
                        </div>
                    </div>
                `;
                
                // Update download button
                const downloadBtn = document.getElementById('downloadSummaryPdf');
                downloadBtn.onclick = () => {
                    window.open(`${API_BASE_URL}${result.download_url}`, '_blank');
                };
                
                // Copy text button
                const copyBtn = document.getElementById('copySummaryText');
                copyBtn.onclick = () => {
                    navigator.clipboard.writeText(result.summary);
                    showMessage('Summary copied to clipboard!', 'success');
                };
                
                showMessage('Summary generated successfully!', 'success');
            } catch (error) {
                loading.style.display = 'none';
                showMessage(`Error: ${error.message}`, 'error');
            }
        }
        
        // Real Worksheet Generator Function
        async function generateWorksheet() {
            const fileInput = document.getElementById('worksheetFileInput');
            const selectedGrades = Array.from(document.querySelectorAll('.grade-option[data-grade].selected'))
                .map(el => el.getAttribute('data-grade'));
            const selectedQuestionTypes = Array.from(document.querySelectorAll('.question-type.selected'))
                .map(el => el.getAttribute('data-type'));
            const difficulty = document.getElementById('difficulty').value;
            
            if (!fileInput.files.length) {
                showMessage('Please select a file first', 'error');
                return;
            }
            
            if (selectedGrades.length === 0) {
                showMessage('Please select at least one grade level', 'error');
                return;
            }
            
            if (selectedQuestionTypes.length === 0) {
                showMessage('Please select at least one question type', 'error');
                return;
            }
            
            const loading = document.getElementById('worksheetLoading');
            const grid = document.getElementById('worksheetsGrid');
            
            loading.style.display = 'block';
            grid.style.display = 'none';
            grid.innerHTML = '';
            
            try {
                const formData = new FormData();
                formData.append('file', fileInput.files[0]);
                formData.append('grades', selectedGrades.join(','));
                formData.append('difficulty', difficulty);
                formData.append('question_types', selectedQuestionTypes.join(','));
                formData.append('output_format', 'pdf');
                
                const result = await makeApiCall('/generate-worksheets/', formData);
                
                loading.style.display = 'none';
                grid.style.display = 'grid';
                
                // Display worksheets for each grade
                let worksheetsHTML = '';
                
                for (const [grade, worksheet] of Object.entries(result.worksheets)) {
                    const gradeDisplay = grade === 'k' ? 'Kindergarten' : 
                                       grade === '1-3' ? 'Grades 1-3' :
                                       grade === '4-6' ? 'Grades 4-6' :
                                       grade === '7-9' ? 'Grades 7-9' : 'Grades 10-12';
                    
                    worksheetsHTML += `
                        <div class="worksheet-card">
                            <div class="worksheet-header">
                                <h3 style="font-weight: 600;">${result.topic || 'Worksheet'}</h3>
                                <span class="worksheet-grade">${gradeDisplay}</span>
                            </div>
                            <div style="margin-bottom: 1rem;">
                                <div style="display: flex; flex-wrap: wrap; gap: 0.5rem; margin-bottom: 0.5rem;">
                                    ${selectedQuestionTypes.map(type => `
                                        <span style="background: rgba(124, 58, 237, 0.2); padding: 0.25rem 0.5rem; border-radius: 4px; font-size: 0.8rem;">
                                            ${type.toUpperCase()}
                                        </span>
                                    `).join('')}
                                </div>
                                <p style="color: var(--text-secondary); font-size: 0.9rem;">
                                    ${difficulty.charAt(0).toUpperCase() + difficulty.slice(1)} difficulty
                                </p>
                            </div>
                            <div class="download-options">
                                <button class="btn download-pdf" style="flex: 1; padding: 0.75rem;"
                                        onclick="window.open('${API_BASE_URL}${worksheet.pdf}', '_blank')">
                                    <i class="fas fa-download"></i> PDF
                                </button>
                                <button class="btn-secondary download-docx" style="flex: 1; padding: 0.75rem;"
                                        onclick="window.open('${API_BASE_URL}${worksheet.docx}', '_blank')">
                                    <i class="fas fa-file-word"></i> DOCX
                                </button>
                            </div>
                        </div>
                    `;
                }
                
                grid.innerHTML = worksheetsHTML;
                
                showMessage(result.message || 'Worksheets generated successfully!', 'success');
            } catch (error) {
                loading.style.display = 'none';
                showMessage(`Error: ${error.message}`, 'error');
            }
        }
        
        // Real Content Generator Function
        async function generateContent() {
            const mainTopic = document.getElementById('mainTopic').value.trim();
            const subjectElement = document.querySelector('.grade-option[data-subject].selected');
            const subject = subjectElement ? subjectElement.getAttribute('data-subject') : 'Computer Science';
            const grades = document.getElementById('contentGrades').value;
            const learningObjectives = document.getElementById('learningObjectives').value;
            const selectedSubtopics = Array.from(document.querySelectorAll('.subtopic-tag.selected span'))
                .map(span => span.textContent)
                .filter(subtopic => subtopic !== mainTopic);
            
            if (!mainTopic) {
                showMessage('Please enter a main topic', 'error');
                return;
            }
            
            const loading = document.getElementById('contentLoading');
            const grid = document.getElementById('contentWorksheets');
            
            loading.style.display = 'block';
            grid.style.display = 'none';
            grid.innerHTML = '';
            
            try {
                const formData = new FormData();
                formData.append('main_topic', mainTopic);
                formData.append('subject', subject);
                formData.append('grades', grades);
                formData.append('difficulty', 'medium');
                formData.append('question_types', 'mcq,theory,essay');
                formData.append('subtopics', selectedSubtopics.join(','));
                formData.append('output_format', 'pdf');
                
                const result = await makeApiCall('/generate-from-topics/', formData);
                
                loading.style.display = 'none';
                grid.style.display = 'grid';
                
                // Display generated content
                let worksheetsHTML = '';
                
                for (const [grade, worksheet] of Object.entries(result.worksheets)) {
                    const gradeDisplay = grade === 'k' ? 'Kindergarten' : 
                                       grade === '1-3' ? 'Grades 1-3' :
                                       grade === '4-6' ? 'Grades 4-6' :
                                       grade === '7-9' ? 'Grades 7-9' : 'Grades 10-12';
                    
                    worksheetsHTML += `
                        <div class="worksheet-card">
                            <div class="worksheet-header">
                                <h3 style="font-weight: 600;">${result.topic}</h3>
                                <span class="worksheet-grade">${gradeDisplay}</span>
                            </div>
                            <p style="color: var(--text-secondary); margin-bottom: 1rem;">
                                Subject: ${result.subject}<br>
                                Subtopics: ${result.subtopics.length ? result.subtopics.join(', ') : 'All relevant aspects'}
                            </p>
                            <div class="download-options">
                                <button class="btn download-pdf" style="flex: 1; padding: 0.75rem;"
                                        onclick="window.open('${API_BASE_URL}${worksheet.pdf}', '_blank')">
                                    <i class="fas fa-download"></i> PDF
                                </button>
                                <button class="btn-secondary download-docx" style="flex: 1; padding: 0.75rem;"
                                        onclick="window.open('${API_BASE_URL}${worksheet.docx}', '_blank')">
                                    <i class="fas fa-file-word"></i> DOCX
                                </button>
                            </div>
                        </div>
                    `;
                }
                
                grid.innerHTML = worksheetsHTML;
                
                showMessage(result.message || 'Learning content generated successfully!', 'success');
            } catch (error) {
                loading.style.display = 'none';
                showMessage(`Error: ${error.message}`, 'error');
            }
        }
        
        // PPT Creator Functions
        let currentPptJobId = null;
        let pptStatusInterval = null;
        
        async function createPresentation() {
            const activeSource = document.querySelector('.ppt-source.selected').getAttribute('data-source');
            const loading = document.getElementById('pptLoading');
            const progressContainer = document.getElementById('pptProgressContainer');
            const progressBar = document.getElementById('pptProgressBar');
            const checkStatusBtn = document.getElementById('checkPptStatus');
            const downloadLink = document.getElementById('pptDownloadLink');
            
            loading.style.display = 'block';
            progressContainer.style.display = 'none';
            progressBar.style.width = '0%';
            progressBar.textContent = '0%';
            checkStatusBtn.style.display = 'none';
            downloadLink.style.display = 'none';
            
            if (activeSource === 'topic') {
                await createPptFromTopic();
            } else {
                await createPptFromDocument();
            }
        }
        
        async function createPptFromTopic() {
            const topic = document.getElementById('pptTopic').value.trim();
            const subject = document.getElementById('pptSubject').value;
            const slideCount = document.getElementById('slideCount').value;
            const style = document.getElementById('pptStyleTopic').value;
            
            if (!topic) {
                showMessage('Please enter a presentation topic', 'error');
                document.getElementById('pptLoading').style.display = 'none';
                return;
            }
            
            try {
                const formData = new FormData();
                formData.append('topic', topic);
                formData.append('subject', subject);
                formData.append('slide_count', slideCount);
                formData.append('style', style);
                formData.append('include_sections', 'title,outline,content,summary');
                
                const result = await makeApiCall('/create-ppt-from-topic/', formData);
                
                document.getElementById('pptLoading').style.display = 'none';
                
                if (result.status === 'success') {
                    showMessage(result.message, 'success');
                    
                    // Show download link
                    const downloadLink = document.getElementById('pptDownloadLink');
                    downloadLink.href = `${API_BASE_URL}${result.download_url}`;
                    downloadLink.textContent = `Download ${result.filename}`;
                    downloadLink.style.display = 'inline-flex';
                    
                    document.getElementById('pptProgressContainer').style.display = 'block';
                }
            } catch (error) {
                document.getElementById('pptLoading').style.display = 'none';
                showMessage(`Error: ${error.message}`, 'error');
            }
        }
        
        async function createPptFromDocument() {
            const fileInput = document.getElementById('pptFileInput');
            const style = document.getElementById('pptStyle').value;
            
            if (!fileInput.files.length) {
                showMessage('Please select a file first', 'error');
                document.getElementById('pptLoading').style.display = 'none';
                return;
            }
            
            try {
                const formData = new FormData();
                formData.append('file', fileInput.files[0]);
                formData.append('style', style);
                formData.append('slide_count', 15);
                
                const result = await makeApiCall('/create-ppt-from-doc/', formData);
                
                document.getElementById('pptLoading').style.display = 'none';
                
                if (result.status === 'success') {
                    showMessage(result.message, 'success');
                    
                    // Show download link
                    const downloadLink = document.getElementById('pptDownloadLink');
                    downloadLink.href = `${API_BASE_URL}${result.download_url}`;
                    downloadLink.textContent = `Download ${result.filename}`;
                    downloadLink.style.display = 'inline-flex';
                    
                    document.getElementById('pptProgressContainer').style.display = 'block';
                }
            } catch (error) {
                document.getElementById('pptLoading').style.display = 'none';
                showMessage(`Error: ${error.message}`, 'error');
            }
        }
        
        async function checkPptStatus() {
            if (!currentPptJobId) return;
            
            try {
                const response = await fetch(`${API_BASE_URL}/check-ppt-status/${currentPptJobId}`);
                const result = await response.json();
                
                const progressBar = document.getElementById('pptProgressBar');
                const checkStatusBtn = document.getElementById('checkPptStatus');
                const downloadLink = document.getElementById('pptDownloadLink');
                
                if (result.status === 'completed') {
                    progressBar.style.width = '100%';
                    progressBar.textContent = '100%';
                    checkStatusBtn.style.display = 'none';
                    
                    downloadLink.href = `${API_BASE_URL}${result.download_url}`;
                    downloadLink.textContent = `Download ${result.filename}`;
                    downloadLink.style.display = 'inline-flex';
                    
                    showMessage('PPT generation completed!', 'success');
                    
                    if (pptStatusInterval) {
                        clearInterval(pptStatusInterval);
                    }
                } else if (result.status === 'processing') {
                    const progress = result.progress || 0;
                    progressBar.style.width = `${progress}%`;
                    progressBar.textContent = `${progress}%`;
                } else if (result.status === 'failed') {
                    showMessage(`PPT generation failed: ${result.error}`, 'error');
                    checkStatusBtn.style.display = 'none';
                    
                    if (pptStatusInterval) {
                        clearInterval(pptStatusInterval);
                    }
                }
            } catch (error) {
                console.error('Error checking PPT status:', error);
            }
        }
    </script>
</body>
</html>